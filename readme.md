EATD_program 是基于预训练音频模型的EATD-Corpus分类项目，主要的训练代码在src文件夹中。

### 项目文件介绍

#### src：

prepare_data.py将EATD音频文件按测试集：训练集=2:8的方式进行划分；

dataset.py负责对数据集的频波形、采样率和标签进行处理；

train_clap.py是主要的模型训练程序；

train_clap_test.py是当时想尝试另一种方法，但没有成功的；

test.py是配置环境时用的临时文件。

#### EATD-Corpus：

数据集源文件

#### CLAP:

包括完整的CLAP模型

#### data：

对数据集进行划分之后的文件，包括train和test两个部分

#### requirements.txt：

环境

----

### 项目历程

上周四：发布任务后开始尝试用CLAP跑ESC50的数据，当晚跑通了，并把微调结果输出保存。

![image-20251024232906726](C:\Users\86150\AppData\Roaming\Typora\typora-user-images\image-20251024232906726.png)

上周五：原本计划把Qwen2_Audio给跑通，但当时下载模型，以及之后的本地部署花了挺长时间，晚上回去简单试了下，但存在报错，主要是环境问题。

周六-周一：因为对模型微调流程不太了解，所以去找了些教程，去了解整个训练的流程。

周二-周五：发现飞书文档上的任务需求改了，原本尝试将剩下两个模型也跑通，但环境问题一直没解决，laion-clap库和transformers的numpy版本要求冲突，故后续的实验一直没推进下去。

之后我尝试了群里同学发的项目文件，但由于缺少环境信息，在本地部署时有些小问题，后来成功跑通了CLAP的模型，accuracy峰值可以达到0.69，最终稳定在0.55左右，与同学的结果差别不大。

----

### 结语

小测试的任务没有很好的完成，不过还是感谢信任，让我有一个学习的机会。这是我第一次接触大模型，整个调试过程学习到很多知识。因为之前一直想着自己把任务完成，过程中缺少了交流，计划这几天与其他实习生请教经验。加油！！！
